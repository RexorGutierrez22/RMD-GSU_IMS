<!DOCTYPE html>
<html>
<head>
    <title>Registration Duplicate Check Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .warning { background: #fff3cd; border-color: #ffeaa7; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        input { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; width: 200px; }
        .form-group { margin: 10px 0; }
        label { display: inline-block; width: 150px; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Registration Duplicate Check Test</h1>

        <div class="section">
            <h3>üìã Test Student Registration</h3>
            <div class="form-group">
                <label>First Name:</label>
                <input type="text" id="student-firstName" value="John" />
            </div>
            <div class="form-group">
                <label>Last Name:</label>
                <input type="text" id="student-lastName" value="Doe" />
            </div>
            <div class="form-group">
                <label>Email:</label>
                <input type="email" id="student-email" value="test@example.com" />
            </div>
            <div class="form-group">
                <label>Student ID:</label>
                <input type="text" id="student-studentId" value="STU2025001" />
            </div>
            <div class="form-group">
                <label>Course:</label>
                <input type="text" id="student-course" value="Computer Science" />
            </div>
            <div class="form-group">
                <label>Year Level:</label>
                <input type="text" id="student-yearLevel" value="3rd Year" />
            </div>
            <div class="form-group">
                <label>Contact:</label>
                <input type="text" id="student-contact" value="09123456789" />
            </div>
            <button onclick="testStudentRegistration()">Test Student Registration</button>
            <div id="student-result"></div>
        </div>

        <div class="section">
            <h3>üè¢ Test Employee Registration</h3>
            <div class="form-group">
                <label>First Name:</label>
                <input type="text" id="employee-first_name" value="Jane" />
            </div>
            <div class="form-group">
                <label>Last Name:</label>
                <input type="text" id="employee-last_name" value="Smith" />
            </div>
            <div class="form-group">
                <label>Email:</label>
                <input type="email" id="employee-email" value="jane@example.com" />
            </div>
            <div class="form-group">
                <label>Employee ID:</label>
                <input type="text" id="employee-emp_id" value="EMP2025001" />
            </div>
            <div class="form-group">
                <label>Position:</label>
                <input type="text" id="employee-position" value="Software Developer" />
            </div>
            <div class="form-group">
                <label>Department:</label>
                <input type="text" id="employee-department" value="IT Department" />
            </div>
            <div class="form-group">
                <label>Contact:</label>
                <input type="text" id="employee-contact" value="09987654321" />
            </div>
            <button onclick="testEmployeeRegistration()">Test Employee Registration</button>
            <div id="employee-result"></div>
        </div>

        <div class="section">
            <h3>üîÑ Test Duplicate Detection</h3>
            <button onclick="testDuplicateEmail()">Test Duplicate Email</button>
            <button onclick="testDuplicateContact()">Test Duplicate Contact</button>
            <button onclick="testDuplicateID()">Test Duplicate ID</button>
            <div id="duplicate-result"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8001/api';

        async function testStudentRegistration() {
            const resultDiv = document.getElementById('student-result');
            resultDiv.innerHTML = 'Testing student registration...';

            const studentData = {
                firstName: document.getElementById('student-firstName').value,
                lastName: document.getElementById('student-lastName').value,
                email: document.getElementById('student-email').value,
                studentId: document.getElementById('student-studentId').value,
                course: document.getElementById('student-course').value,
                yearLevel: document.getElementById('student-yearLevel').value,
                contact: document.getElementById('student-contact').value
            };

            try {
                const response = await fetch(`${API_BASE}/students`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                    },
                    body: JSON.stringify(studentData)
                });

                const data = await response.json();

                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="success">
                            ‚úÖ Student Registration Success!<br>
                            <strong>Student:</strong> ${data.student.name}<br>
                            <strong>ID:</strong> ${data.student.student_id}<br>
                            <strong>Message:</strong> ${data.message}
                        </div>`;
                } else {
                    let errorHtml = `
                        <div class="error">
                            ‚ùå Registration Failed<br>
                            <strong>Message:</strong> ${data.message}<br>
                    `;

                    if (data.errors) {
                        errorHtml += '<strong>Errors:</strong><br>';
                        for (const field in data.errors) {
                            errorHtml += `‚Ä¢ ${field}: ${data.errors[field].join(', ')}<br>`;
                        }
                    }

                    errorHtml += '</div>';
                    resultDiv.innerHTML = errorHtml;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        ‚ùå Network Error: ${error.message}
                    </div>`;
            }
        }

        async function testEmployeeRegistration() {
            const resultDiv = document.getElementById('employee-result');
            resultDiv.innerHTML = 'Testing employee registration...';

            const employeeData = {
                first_name: document.getElementById('employee-first_name').value,
                last_name: document.getElementById('employee-last_name').value,
                email: document.getElementById('employee-email').value,
                emp_id: document.getElementById('employee-emp_id').value,
                position: document.getElementById('employee-position').value,
                department: document.getElementById('employee-department').value,
                contact: document.getElementById('employee-contact').value
            };

            try {
                const response = await fetch(`${API_BASE}/employees`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                    },
                    body: JSON.stringify(employeeData)
                });

                const data = await response.json();

                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="success">
                            ‚úÖ Employee Registration Success!<br>
                            <strong>Employee:</strong> ${data.employee.name}<br>
                            <strong>ID:</strong> ${data.employee.emp_id}<br>
                            <strong>Message:</strong> ${data.message}
                        </div>`;
                } else {
                    let errorHtml = `
                        <div class="error">
                            ‚ùå Registration Failed<br>
                            <strong>Message:</strong> ${data.message}<br>
                    `;

                    if (data.errors) {
                        errorHtml += '<strong>Errors:</strong><br>';
                        for (const field in data.errors) {
                            errorHtml += `‚Ä¢ ${field}: ${data.errors[field].join(', ')}<br>`;
                        }
                    }

                    errorHtml += '</div>';
                    resultDiv.innerHTML = errorHtml;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        ‚ùå Network Error: ${error.message}
                    </div>`;
            }
        }

        function testDuplicateEmail() {
            document.getElementById('employee-email').value = document.getElementById('student-email').value;
            document.getElementById('duplicate-result').innerHTML =
                '<div class="warning">Set employee email to match student email. Try employee registration now.</div>';
        }

        function testDuplicateContact() {
            document.getElementById('employee-contact').value = document.getElementById('student-contact').value;
            document.getElementById('duplicate-result').innerHTML =
                '<div class="warning">Set employee contact to match student contact. Try employee registration now.</div>';
        }

        function testDuplicateID() {
            // Try registering student again with same student ID
            document.getElementById('duplicate-result').innerHTML =
                '<div class="warning">Try registering the same student again to test duplicate ID detection.</div>';
        }
    </script>
</body>
</html>
